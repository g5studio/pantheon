---
description: Figma DSM 管理工具：檢查、新增、更新、移除 DSM 變數
---

## 簡化指令

**`check-figma`** - Figma DSM 管理工具（推薦使用）

當用戶輸入 `check-figma` 時，**先詢問用戶目的**，然後執行對應的功能。

---

## 執行流程

### 步驟 1: 詢問用戶目的（必填）

當用戶輸入 `check-figma` 時，**必須先詢問用戶想要執行哪個功能**，提供以下 5 個預設選項：

```
🎨 Figma DSM 管理工具

請選擇要執行的功能：

1. 檢查特定業主 DSM 設置是否與線上 Figma 有出入，並生成檢查報告
2. 檢查全營運業主 DSM 設置是否與線上 Figma 有出入，並生成檢查報告
3. 新增 DSM 變數
4. DSM 變數色碼更新（對齊線上 Figma 設置）
5. 移除 DSM 變數

請輸入選項編號（1-5）：
```

**重要：** 必須等待用戶選擇後再執行對應功能。

---

## 功能 1: 檢查特定業主 DSM 設置

### 執行步驟

1. **詢問業主編號**（必填）
   - 格式：`vdXXX`（例如：`vd001`, `vd004`, `vd007`）
   - 必須是有效的營運業主編號

2. **從 Figma 獲取 DSM 數據**
   - 自動使用 Figma API 獲取指定業主的 DSM 變數
   - Token: 優先使用環境變數 `FIGMA_ACCESS_TOKEN`

3. **從程式碼提取 DSM 變數**
   - 讀取對應業主的 DSM 變數配置
   - 提取日間模式和夜間模式的變數

4. **比較差異**
   - 比較 Figma 和程式碼中的變數名稱
   - 比較色碼值差異
   - 識別只存在於 Figma 中的變數
   - 識別只存在於程式碼中的變數
   - 識別兩邊都存在但色碼值不同的變數

5. **生成檢查報告**

**使用的腳本：**
- `.cursor/scripts/agent-operator/compare-vendor-dsm-figma.mjs`

---

## 功能 2: 檢查全營運業主 DSM 設置

### 執行步驟

1. **自動檢查所有營運業主**
2. **批量執行檢查**
3. **生成總體報告**

**使用的腳本：**
- `.cursor/scripts/agent-operator/check-all-vendors-dsm.mjs`

---

## 功能 3: 新增 DSM 變數

### 執行步驟

1. **詢問 DSM 名稱**（必填）
2. **驗證 DSM 是否已存在**
3. **自動判斷為全業主共用或業主客製化**
4. **執行新增流程**

**使用的腳本：**
- `.cursor/scripts/agent-operator/read-figma-dsm.mjs`

---

## 功能 4: DSM 變數色碼更新

### 執行步驟

1. **詢問 DSM 名稱**（必填）
2. **驗證 DSM 是否存在**
3. **從 Figma 獲取最新色碼值**
4. **判斷更新範圍**
5. **執行更新**
6. **顯示更新摘要**

---

## 功能 5: 移除 DSM 變數

### 執行步驟

1. **詢問 DSM 名稱**（必填）
2. **驗證線上 Figma 無此變數**
3. **確認移除範圍**
4. **執行移除**
5. **顯示移除摘要**

**使用的腳本：**
- `.cursor/scripts/agent-operator/read-figma-dsm.mjs`
- `.cursor/scripts/agent-operator/check-dsm-vendors.mjs`

---

## 注意事項

1. **必須先詢問用戶目的**：執行 `check-figma` 時，必須先顯示功能選項，等待用戶選擇後再執行
2. **報告格式**：功能 1 和 2 的報告格式必須完整列出所有異常變數
3. **Figma 驗證**：功能 5（移除 DSM 變數）必須先驗證 Figma 中不存在該變數

